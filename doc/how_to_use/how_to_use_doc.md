# 使い方

## キーボード操作について

キーボード操作一覧

| ボタン | 機能 |
| -- | -- |
| W | 前進 |
| S | 後退 |
| A | 反時計回りに回転 |
| D | 時計回りに回転 |
| Space | 入力モードの切替 |
| O | 運搬物を取る |
| P | 運搬物を置く |

## 移動について

キーを押した時の移動速度は、前進後退は 1[m/s] 、回転は 1[rad/s] です。

## 入力モードの切替について

実行中、キーボードのSpaceキーを押すことで、入力モードを切り替えることができます。起動時は COMMUNICATION モードになっています。

- COMMUNICATION モード
  - 外部アプリから入力でロボットを操作するモードです。
  - キーボードからの入力では、ロボットを動かすことができません。
- KEYBOARD モード
  - キーボードの前進、後退、回転入力を用いてロボットを操作するモードです。
  - 外部アプリからの入力では、ロボットを動かすことができません。

## 運搬について

ゲームオブジェクト「flasket」に置かれているカップを取ってトレーに乗せ、運び、机に置くことができます。

ロボットがカップに1[m]以内に近づいた時、カップを取ることができます。また、ロボットがカップを置く場所に1[m]以内に近づいた時、カップを置くことができます。

カップを置くことができる場所は、初期位置の flasket と、各椅子がある場所の机の上になります。

## ROS通信

ROS通信を行う場合は、事前に ROS TCP Endpoint を起動する必要があります。Maid Robot System では、ROS2を用いています。

ROS TCP Endpoint は、事前にインストール作業が必要になります。作業の詳細についてはインストール方法の資料を参照してください。
[インストール方法](../install/install_doc.md)

### ROS TCP Endpoint の起動

セットアップコマンドを実行します。Ubuntu起動時にセットアップコマンドを実行するようにしている場合は不要です。

次に、以下のコマンドを実行します。

> ros2 run ros_tcp_endpoint default_server_endpoint --ros-args -p ROS_IP:=127.0.0.1

上記コマンドでは、IPアドレスは 127.0.0.1 に設定していますが、別のアドレスを使うこともできます。その場合は、Unity 編集画面のメニューバーの「Robotics」「ROS Settings」から、IPアドレスをその別のアドレスに変更する必要があります。

### ROS トピック

送受信しているトピックは以下の通りです。

| 受信トピック名 | データ型 | 備考 |
| ---- | ---- | ---- |
| move_velocity_reference | geometry_msgs/Twist | ロボットの3軸速度、3軸角速度指令値です。ただし、現時点では、受け取った指令値の内、x軸方向速度とz軸周りの角速度のみ、指令値として用います。 |

<br>

| 送信トピック名 | データ型 | 備考 |
| ---- | ---- | ---- |
| robot_position_orientation | geometry_msgs/PoseStamped | ロボットの現在のXYZ位置、クオータニオンで表現された姿勢の情報です。本トピックは0.5[s]間隔で送信されます。 |
